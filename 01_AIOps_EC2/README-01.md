# 실습 1. AIOps for EC2 상태분석 (상태실패)

## 1) 과정내용 - 설명

> 실습을 진행하시는 도중 Amazon Q dev CLI가 의도하지 않게 동작하는 경우가 발생할 수 있습니다. 그 때에는 안내된 과정 외에도 추가로 요청하시어 목표에 도달할 수 있도록 직접 요청을 수행해보시기 바랍니다.

## 이 과정은 Q CLI 를 이용하여 인스턴스의 상태를 분석하고 복구하는 과정을 시도합니다. 
📢 'test-valkey-cluster' 클러스터에 연결된 Application에서 예기치 않은 connection error 문제가 발생했습니다.

Amazon Q dev CLI를 통해 해당 원인을 조사합니다.


## 2) 진행순서 - 실습

> 혹시나 아직 테스트용 인스턴스를 생성하지 않았다면 아래 페이지를 다시 방문해 주세요.

- [사전작업-테스트용 EC2 생성](Create-test-EC2.md)


2-1). Q CLI 를 실행하고 다음과 같이 요청합니다. ( 순서대로, 혹은 편한 방법으로 진행합니다. )

```
q chat
```

* 언어를 지정하지 않는 경우에 영/한 이 랜덤하게 나옵니다. 
```
이후 대화는 Korean 한글로 진행해줘
```

* 제공되는 인스턴스ID 만으로는 정보가 부족하여 인스턴스를 특정할 수 없을때에는 추가적인 정보를 같이주도록 요청하면 좋습니다. 
```
ap-northeast-2 에 인스턴스 상태를 확인하고 비정상인 것만 알려줘. 정상인 것은 제외해.
내가 대상을 알아볼 수 있는 이름,태그,IP,vpc,az 등의 정보를 포함해줘.
```

* 볼륨의 이상을 복구하기 위해서 진행해야 할 계획을 미리 살펴볼 수 있습니다. 
```
해당 인스턴스의 상태 및 원인을 확인된 데이터 기반으로 분석한후 복구 계획을 세워줘. 각 단계를 숫자로 지정하여 계획하도록해
```

* 복구 과정중에는 사람처럼 예외적이거나 다른 방향성을 진해할 수도 있습니다. 이 경우를 예방합니다. 
```
복구과정을 진행하면서 각 단계별로 명령어를 제공후 실행해줘.
예외사항이 발생하면 분석한 정보와 내용을 제공한후 확인한 후 내게 허락을 받은후 진행 하도록 해.
실제 확인된 정보를 기초로만 작업을 진행하고 가정 과 가설은 제외해.
각 단계를 진행전 진행할지 물어보고 진행하고, 진행과정의 상태를 데이터와 결과를 확인하면서 진행하도록 해
```

* UUID 중복으로 인하여 복구볼륨 마운트를 실패할 수 있습니다. 자동으로 이를 확인하는 경우도 있지만 안하는 경우 아래 내용을 시도해 보세요.
```
시스템 로그를 분석해서 마운트에 실패한 원인을 찾아줘
```

* 이후 남아있는 과정을 계속 진행하도록 요청합니다. 
```
복원 과정을 이어서 진행해줘
```

2-2). 이후 Q CLI 와 자유롭게 대화를 나누면서 복구과정을 진행하여 보세요.

- 복구 과정중에는 여러가지 다른 상황들이 발생할 수 있습니다. 상황에 맞게 대응을 하거나 원하는 것을 이야기 해주세요.

2-3). 최종적으로 복구가 완료되었는지를 확인해 보시기 바랍니다. 그후 리포트를 만듭니다. 
```
전채 과정을 요약 정리하여 리포트로만들어 주고, 같은이슈 반복시에 해결방법을 가이드 스텝형태로 만들어줘
```

